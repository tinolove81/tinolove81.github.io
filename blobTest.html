<!DOCTYPE html>
<html>

<head>
    <meta charset='UTF-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no'>
    <link rel='stylesheet' href='./asset/css/bootstrap.min.css' />
    <link rel='icon' href='./favicon.ico' type='image/x-icon'>
    <script src='./asset/js/jquery-3.2.1.min.js'></script>
    <script src='./asset/js/bootstrap.bundle.min.js'></script>
    <title>Goodbye world !</title>
    <style>
        @import url('https://fonts.googleapis.com/css?family=Imprima');
        @import url('https://fonts.googleapis.com/css?family=Noto Sans JP');
        html,
        body {
            height: 100%;
            font-family: Imprima, 'Noto Sans JP';
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>

<body>
    
    <div id='myDiv' class=''></div>

    <script>
    // Data to Blob
        let blob = new Blob(['Array', 'Blob', 'DOMString'], {type: 'text/csv;charset=utf-8;'});
    // Blob to Object URL
        let filename = 'ArrayOrBlob.csv';
        if (navigator.msSaveBlob) { // IE 10+
            navigator.msSaveBlob(blob, filename);
        } else {
            // FF need real DOM to trigger
            // let link = document.querySelector('#QuerypageInputBtn03'); 
            let link = document.createElement('a'); 
            link.setAttribute('href', URL.createObjectURL(blob));
            link.setAttribute('target', '_blank');
            link.setAttribute('download', filename);
            link.click();
        }

    /* 拆包
        var blobUrl = document.querySelector('video').src;
        var data, blobUrl;
        var URL_o = Object.assign({}, URL);
        URL = {
            'createObjectURL': function (e) {
                console.log('createObjectURL: #START###############################################');
                console.log(e);
                console.log('createObjectURL: #END#################################################');
                data = e;
                blobUrl = URL_o.createObjectURL(e);
                return blobUrl;
            },
            'revokeObjectURL': function (e) {
                console.log('revokeObjectURL: #START###############################################');
                console.log(e);
                console.log('revokeObjectURL: #END#################################################');
            }
        }

        var setTimeout_o = setTimeout;
        setTimeout=(f, t)=>{if(t>2000)console.log(f, t);setTimeout_o(f, t);}

        _yt_player.Vo.getInstance()??
        _yt_player.E=()=>{return 2599999999999;}
    */


    // Get Data from Blob
        let reader = new FileReader();
        reader.addEventListener('loadend', function() {
            base64data = reader.result;                
            console.log(base64data);
        });
        reader.readAsArrayBuffer(blob);

    // Get Blob from Object URL
function b() {
let blobUrl = document.querySelector('video').src;
let xhr = new XMLHttpRequest();
xhr.open('GET', blobUrl);
xhr.responseType = 'blob';
xhr.onload = function(e) {
    if (this.status == 200) {
        var myBlob = this.response;
        console.log(myBlob);
    }
};
xhr.send();
}

    (fx=()=>{
        var gm = (window.yt && window.yt.config_ || window.ytcfg && window.ytcfg.data_)['EXPERIMENT_FLAGS'];
        var m = `### Youtube Config Test ###\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n`;
            m += ` window['_lact'] = ${window['_lact']}  (${new Date(window['_lact']).toLocaleString()})\t\t\t\t\t\t\n`;
            m += ` window['_fact'] = ${window['_fact']}\t\t\t\t\t\t\t\t\t\t\t\t\n`;
            m += ` Last activity pass: ${new Date(+new Date-window['_lact']).toISOString().substr(11, 8)}\t\t\t\t\t\t\t\t\t\t\t\t\t\n`;
            m += ` gm['user_engagement_enable_autoplay_pause_feature']: ${gm['user_engagement_enable_autoplay_pause_feature']}\t\t\t\t\t\n`;
            m += ` gm['is_part_of_any_user_engagement_experiment']: ${gm['is_part_of_any_user_engagement_experiment']}\t\t\t\t\t\t\t\n`;
            m += ` gm['enable_watch_next_pause_autoplay_lact']: ${gm['enable_watch_next_pause_autoplay_lact']}\t\t\t\t\t\t\t\t\n`;
            m += ` gm['watch_next_pause_autoplay_lact_sec']: ${gm['watch_next_pause_autoplay_lact_sec']} (s)\t\t\t\t\t\t\t\t\n`;
            m += ` gm['autoplay_pause_by_lact_sec']: ${gm['autoplay_pause_by_lact_sec']} (s)\t\t\t\t\t\t\t\t\t\t\n`;

            m += ` Next expected pause time: ${new Date(window['_lact']+gm['watch_next_pause_autoplay_lact_sec']*1E3).toLocaleString()}\t\t\t\t\t\t\t\t\n`;
        console.log('%c'+m, 'background:#222;color:#CFA');
    })()

/*
    enable_autoplay_pause_by_lact

    new Date(window["_lact"])
    gm = (window.yt && window.yt.config_ || window.ytcfg && window.ytcfg.data_)['EXPERIMENT_FLAGS'];

    gm["user_engagement_enable_autoplay_pause_feature"]
    gm["is_part_of_any_user_engagement_experiment"]
    gm["enable_watch_next_pause_autoplay_lact"]
    gm["watch_next_pause_autoplay_lact_sec"]

    gm["autoplay_pause_by_lact_sec"]

    _yt_player.M.prototype.Tu()
*/

    </script>
</body>

</html>
