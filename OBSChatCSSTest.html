<!DOCTYPE html>
<html lang='zh-tw'>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='expires' content='0'>
    <Meta http-equiv='Pragma' Content='No-cache'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=0'>
    <link href='https://bootstrap.hexschool.com/dist/css/bootstrap.css' rel='stylesheet'>
    <!-- <link href='file:///D:/VSCodeWorkSpace/CMSWebServer/css/bootstrap.min.css' rel='stylesheet'> -->
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
    <!-- <script src='file:///D:/VSCodeWorkSpace/CMSWebServer/js/jquery-3.2.1.min.js'></script> -->
    <title>OBS Chat CSS Test</title>
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            font-family: consolas, 'Meiryo', 'Microsoft JhengHei';
            background: url("https://pics.prcm.jp/a538fc10cb21a/47076940/jpeg/47076940.jpeg") left center no-repeat;
        }
        body {
            position: relative;
            padding-top: 56px;
            overflow: hidden;
        }

        body > div {
            height: calc(100%);
        }

        iframe {
            display: block;
            width: 300px;
            height: 450px;
        }
        input {
            background: rgba(255, 255, 255, .7) !important;
        }
        input::placeholder {
            color: rgba(170, 204, 255, .7) !important;
        }
        input::-webkit-input-placeholder {
            color: rgba(170, 204, 255, .7) !important;
        }
        input::-moz-placeholder {
            color: rgba(170, 204, 255, .7) !important;
        }
        input::-ms-input-placeholder {
            color: rgba(170, 204, 255, .7) !important;
        }

        .mask_for_iframe {
            position: absolute;
            margin: 0;
            padding: 0;
            color: transparent;
            background: rgba(255, 255, 255, 0);
            border: 0;
            z-index: 3;
        }

        .border-dotted {
            border-style: dotted !important;
        }

    </style>
</head>

<body class='container-fluid'>
    <!-- As a heading -->
    <nav class='navbar navbar-dark bg-dark rounded fixed-top'>
        <span class='navbar-brand mb-0 h1'>Navbar</span>
    </nav>
    <div class='d-flex flex-column'>
        <div class='row h-100'>
            
        <!-- Detail Area -->
            <div id='ModifyArea' class='col-6 h-100'>
                <div class='row mt-2'>
                    <div class='col-12 mb-2'>
                        <strong class='input-group-text'>聊天室本體(#chat_box)</strong>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>聊天室字色</span></div>
                            <input type='text' id='CB_color' class='form-control' placeholder='#D3D3D3' />
                        </div>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>聊天室背景色</span></div>
                            <input type='text' id='CB_bgcolor' class='form-control' placeholder='transparent' />
                        </div>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>聊天室字體大小</span></div>
                            <input type='text' id='CB_fontsize' class='form-control' placeholder='16px' />
                        </div>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>聊天室字體粗細</span></div>
                            <input type='text' id='CB_fontwidth' class='form-control' placeholder='300' />
                        </div>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>聊天室字型</span></div>
                            <input type='text' id='CB_fomefamily' class='form-control' placeholder='"Helvetica Neue", Helvetica, Arial, sans-serif' />
                        </div>
                    </div>
                </div>
                <div class='row mt-2'>
                    <div class='col-12 mb-2'>
                        <strong class='input-group-text'>聊天室單行(.chat_line)</strong>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>單行邊界</span></div>
                            <input type='text' id='CL_margin' class='form-control' placeholder='0' />
                        </div>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>單行字元間距</span></div>
                            <input type='text' id='CL_margin' class='form-control' placeholder='1rem' />
                        </div>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>單行動畫</span></div>
                            <input type='text' id='CL_margin' class='form-control' placeholder='' />
                        </div>
                    </div>
                </div>
                <div class='row mt-2'>
                    <div class='col-12 mb-2'>
                        <strong class='input-group-text'>單行暱稱(.nick)</strong>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'>
                                <div class='input-group-text'><input type='checkbox' id='CLN_shadow_cb' /></div>
                            </div>
                            <div class='input-group-prepend'>
                                <span class='input-group-text'>陰影粗細</span>
                            </div>
                            <input type='text' id='CLN_shadowwidth' class='form-control' placeholder='1px' />
                            <div class='input-group-prepend'>
                                <span class='input-group-text'>陰影顏色</span>
                            </div>
                            <input type='text' id='CLN_shadowcolor' class='form-control' placeholder='#000000' />
                        </div>
                    </div>
                </div>
                <div class='row mt-2'>
                    <div class='col-12 mb-2'>
                        <strong class='input-group-text'>聊天內容(.message)</strong>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>字色</span></div>
                            <input type='text' id='CLM_color' class='form-control' placeholder='#FFF' />
                        </div>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'>
                                <div class='input-group-text'><input type='checkbox' id='CLM_shadow_cb' /></div>
                            </div>
                            <div class='input-group-prepend'>
                                <span class='input-group-text'>陰影粗細</span>
                            </div>
                            <input type='text' id='CLM_shadowwidth' class='form-control' placeholder='1px' />
                            <div class='input-group-prepend'>
                                <span class='input-group-text'>陰影顏色</span>
                            </div>
                            <input type='text' id='CLM_shadowcolor' class='form-control' placeholder='#000000' />
                        </div>
                    </div>
                </div>
                <div class='row mt-2 d-none'>
                    <div class='col-12 mb-2'>
                        <strong class='input-group-text'>聊天室單行(.chat_line)</strong>
                        <div class='input-group input-group-sm'>
                            <div class='input-group-prepend'><span class='input-group-text'>##</span></div>
                            <input type='text' id='CL_margin' class='form-control' placeholder='###' />
                        </div>
                    </div>
                </div>
                <div class='row mt-2 d-none'>
                    <div class='col-12'>
                        <textarea class='w-100 h-100'>
::-webkit-scrollbar {
    visibility: hidden;
}

#chat_box {
}

.chat_line {
}

.chat_line .nick {
}

.chat_line .message {
}
                        </textarea>
                    </div>
                    <div class='col-12'>
                        <textarea id='textarea02' class='w-100 h-100'>
::-webkit-scrollbar {
    visibility: hidden;
}

#chat_box {
    padding: 0;
    color: white;
    background: transparent;
    font-size: 16px;
    font-weight: 300;
    font-family: 'Meiryo', 'Microsoft JhengHei';
}

.chat_line {
    margin: 2px;
    padding: 0;
    line-height: 1rem;
    animation: slideInRight .6s cubic-bezier(.2, 1, .3, 1);
}

.chat_line .time_stamp {
    display: none;
}

.chat_line .nick {
    text-shadow: 0 -1px #000,
    1px -1px #000,
    1px 0 #000,
    1px 1px #000,
    0 1px #000,
    -1px 1px #000,
    -1px 0 #000,
    -1px -1px #000;
}

.chat_line .message {
    color: white;
    text-shadow: 0 -1px #000,
    1px -1px #000,
    1px 0 #000,
    1px 1px #000,
    0 1px #000,
    -1px 1px #000,
    -1px 0 #000,
    -1px -1px #000;
}

@keyframes slideInRight {
    0% {
        -webkit-transform: translateX(100%);
        transform: translateX(100%);
        visibility: visible;
    }
    100% {
        -webkit-transform: translateX(0);
        transform: translateX(0);
    }
}
                        </textarea>
                    </div>
                </div>
            </div>
        <!-- /Detail Area -->

        <!-- Display Area -->
            <div id='DisplayArea' class='col-6 d-flex flex-column'>
                <div class='row mt-2'>
                    <div class='col-12'>
                        <div class='input-group input-group-sm mb-2'>
                            <div class='input-group-prepend'><span class='input-group-text'>Width</span></div>
                            <input type='text' id='DisplayAreaInput02' class='form-control' placeholder='300' />
                            <div class='input-group-prepend'><span class='input-group-text'>Height</span></div>
                            <input type='text' id='DisplayAreaInput03' class='form-control' placeholder='450' />
                            <div class='input-group-append'>
                                <button id='DisplayAreaSubmit' class='btn btn-outline-success btn-sm' type='button'>Submit</button>
                                <button id='DisplayAreaCancel' class='btn btn-outline-success btn-sm' type='button'>Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class='row mt-2 mb-2'>
                    <div class='col-12'>
                        <div class='btn-group btn-group-sm btn-group-toggle' data-toggle='buttons'>
                            <label class='btn btn-secondary active'>
                                <input class='form-check-input' type='radio' name='DisplayBGRadio' value='white' checked>
                                <span>White</span>
                            </label>
                            <label class='btn btn-secondary'>
                                <input class='form-check-input' type='radio' name='DisplayBGRadio' value='black'>
                                <span>Black</span>
                            </label>
                            <label class='btn btn-secondary'>
                                <input class='form-check-input' type='radio' name='DisplayBGRadio' value='yellow'>
                                <span>Yellow</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class='row mt-2 flex-grow-1'>
                    <div class='col-12'>
                        <div class='position-relative w-100 h-100 border'>
                            <iframe id='DisplayAreaIframe' class='position-absolute border border-dotted' src=''></iframe>
                        </div>
                    </div>
                </div>
            </div>
        <!-- /Display Area -->

        </div>
    </div>
    <div id='MaskForIframe' class='mask_for_iframe'></div>

    <script>
        let $iframe = $('#DisplayAreaIframe');
        let $mask = $('#MaskForIframe');
        let $Dargging = null;
        let mouse_pos = null;

        $(function() { 
            iframeMask();
            

        }); 

        $('#DisplayAreaSubmit').on('click', () => {
            let if_w = parseInt($('#DisplayAreaInput02').val()) || 300;
            let if_h = parseInt($('#DisplayAreaInput03').val()) || 450;

            $iframe.prop('src', location.toString().replace('Test', 'Example'));
            $iframe.css('width', if_w);
            $iframe.css('height', if_h);

            $iframe.on('load', function() {
                ImportCSS();
            });
            iframeMask();
        });
        $('#DisplayAreaCancel').on('click', () => {
            let if_w = parseInt($('#DisplayAreaInput02').val()) || 300;
            let if_h = parseInt($('#DisplayAreaInput03').val()) || 450;

            $iframe.prop('src', location.toString().replace('Test', 'Example'));
            $iframe.css('width', if_w);
            $iframe.css('height', if_h);

            $iframe.off('load');
            iframeMask();
        });
        $mask.on('mousemove', function (e) {
            if ($Dargging) {
                let top_border = $iframe.parent().offset()['top'];
                let right_border = $iframe.parent().offset()['left'] + $iframe.parent().outerWidth();
                let buttom_border = $iframe.parent().offset()['top'] + $iframe.parent().outerHeight();
                let left_border = $iframe.parent().offset()['left'];

                if ($Dargging.offset()['top'] + (e.clientY - mouse_pos['top']) < top_border) {
                    $Dargging.css('top', top_border);
                    $iframe.css('top', 0);
                } else if ($Dargging.offset()['top'] + (e.clientY - mouse_pos['top']) + $Dargging.outerHeight() > buttom_border) {
                    $Dargging.css('top', buttom_border - $Dargging.outerHeight());
                    $iframe.css('top', $iframe.parent().outerHeight() - $iframe.outerHeight());
                } else {
                    $Dargging.css('top', '+=' + (e.clientY - mouse_pos['top']));
                    $iframe.css('top', '+=' + (e.clientY - mouse_pos['top']));
                }

                if ($Dargging.offset()['left'] + (e.clientX - mouse_pos['left']) < left_border) {
                    $Dargging.css('left', left_border);
                    $iframe.css('left', 0);
                } else if ($Dargging.offset()['left'] + (e.clientX - mouse_pos['left']) + $Dargging.outerWidth() > right_border) {
                    $Dargging.css('left', right_border - $Dargging.outerWidth());
                    $iframe.css('left', $iframe.parent().outerWidth() - $iframe.outerWidth());
                } else {
                    $Dargging.css('left', '+=' + (e.clientX - mouse_pos['left']));
                    $iframe.css('left', '+=' + (e.clientX - mouse_pos['left']));
                }

                mouse_pos = {
                    'top': e.clientY,
                    'left': e.clientX
                };
            }
        });
        $mask.on('mousedown', function (e) {
            $Dargging = $(e.target);
            mouse_pos = {
                'top': e.clientY,
                'left': e.clientX
            };
        });
        $mask.on('mouseup', function (e) {
            $Dargging = null;
            mouse_pos = null;
        });
        $mask.on('mouseleave', function (e) {
            $Dargging = null;
            mouse_pos = null;
        });
        $('input[name="DisplayBGRadio"]').on('click', function (e) {
            let element = $(e.target);
            element.parent().parent().find('label.active').removeClass('active');
            element.parent().addClass('active');
            switch (element.val()) {
                case 'black':
                    $iframe.parent().css('background', 'black');
                    break;
                case 'white':
                    $iframe.parent().css('background', 'white');
                    break;
                case 'yellow':
                    $iframe.parent().css('background', 'yellow');
                    break;
                default:
                    break;
            }
        });

        function iframeMask() {
            $mask.css('top', $iframe.offset()['top']);
            $mask.css('left', $iframe.offset()['left']);
            $mask.css('width', $iframe.outerWidth());
            $mask.css('height', $iframe.outerHeight());
        }
        function ImportCSS() {
            $('iframe').contents().find('head').append('<style>' + $('#textarea02').val() + '</style>');
        }
        

    </script>
</body>

</html>